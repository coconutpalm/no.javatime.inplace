<html>

<head>
<meta http-equiv=Content-Type content="text/html; charset=utf-8">
<meta name=Generator content="Microsoft Word 14 (filtered)">
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Cambria;
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:"Arial Rounded MT Bold";
	panose-1:2 15 7 4 3 5 4 3 2 4;}
@font-face
	{font-family:Consolas;
	panose-1:2 11 6 9 2 2 4 3 2 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:10.0pt;
	margin-left:0cm;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
h1
	{mso-style-link:"Heading 1 Char";
	margin-top:24.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	margin-bottom:.0001pt;
	line-height:115%;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Cambria","serif";
	color:#365F91;}
h2
	{mso-style-link:"Heading 2 Char";
	margin-top:10.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	margin-bottom:.0001pt;
	line-height:115%;
	page-break-after:avoid;
	font-size:13.0pt;
	font-family:"Cambria","serif";
	color:#4F81BD;}
p.MsoToc1, li.MsoToc1, div.MsoToc1
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:5.0pt;
	margin-left:0cm;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoToc2, li.MsoToc2, div.MsoToc2
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:5.0pt;
	margin-left:11.0pt;
	line-height:115%;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoHeader, li.MsoHeader, div.MsoHeader
	{mso-style-link:"Header Char";
	margin:0cm;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{mso-style-link:"Footer Char";
	margin:0cm;
	margin-bottom:.0001pt;
	font-size:11.0pt;
	font-family:"Calibri","sans-serif";}
p.MsoTitle, li.MsoTitle, div.MsoTitle
	{mso-style-link:"Title Char";
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:15.0pt;
	margin-left:0cm;
	border:none;
	padding:0cm;
	font-size:26.0pt;
	font-family:"Cambria","serif";
	color:#17365D;
	letter-spacing:.25pt;}
p.MsoTitleCxSpFirst, li.MsoTitleCxSpFirst, div.MsoTitleCxSpFirst
	{mso-style-link:"Title Char";
	margin:0cm;
	margin-bottom:.0001pt;
	border:none;
	padding:0cm;
	font-size:26.0pt;
	font-family:"Cambria","serif";
	color:#17365D;
	letter-spacing:.25pt;}
p.MsoTitleCxSpMiddle, li.MsoTitleCxSpMiddle, div.MsoTitleCxSpMiddle
	{mso-style-link:"Title Char";
	margin:0cm;
	margin-bottom:.0001pt;
	border:none;
	padding:0cm;
	font-size:26.0pt;
	font-family:"Cambria","serif";
	color:#17365D;
	letter-spacing:.25pt;}
p.MsoTitleCxSpLast, li.MsoTitleCxSpLast, div.MsoTitleCxSpLast
	{mso-style-link:"Title Char";
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:15.0pt;
	margin-left:0cm;
	border:none;
	padding:0cm;
	font-size:26.0pt;
	font-family:"Cambria","serif";
	color:#17365D;
	letter-spacing:.25pt;}
a:link, span.MsoHyperlink
	{color:blue;
	text-decoration:underline;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{mso-style-link:"Balloon Text Char";
	margin:0cm;
	margin-bottom:.0001pt;
	font-size:8.0pt;
	font-family:"Tahoma","sans-serif";}
p.MsoTocHeading, li.MsoTocHeading, div.MsoTocHeading
	{margin-top:24.0pt;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:0cm;
	margin-bottom:.0001pt;
	line-height:115%;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Cambria","serif";
	color:#365F91;
	font-weight:bold;}
span.HeaderChar
	{mso-style-name:"Header Char";
	mso-style-link:Header;}
span.FooterChar
	{mso-style-name:"Footer Char";
	mso-style-link:Footer;}
span.Heading1Char
	{mso-style-name:"Heading 1 Char";
	mso-style-link:"Heading 1";
	font-family:"Cambria","serif";
	color:#365F91;
	font-weight:bold;}
span.Heading2Char
	{mso-style-name:"Heading 2 Char";
	mso-style-link:"Heading 2";
	font-family:"Cambria","serif";
	color:#4F81BD;
	font-weight:bold;}
span.BalloonTextChar
	{mso-style-name:"Balloon Text Char";
	mso-style-link:"Balloon Text";
	font-family:"Tahoma","sans-serif";}
span.TitleChar
	{mso-style-name:"Title Char";
	mso-style-link:Title;
	font-family:"Cambria","serif";
	color:#17365D;
	letter-spacing:.25pt;}
.MsoChpDefault
	{font-family:"Calibri","sans-serif";}
.MsoPapDefault
	{margin-bottom:10.0pt;
	line-height:115%;}
 /* Page Definitions */
 @page WordSection1
	{size:595.3pt 841.9pt;
	margin:70.85pt 70.85pt 70.85pt 70.85pt;}
div.WordSection1
	{page:WordSection1;}
-->
</style>

</head>

<body lang=EN-US link=blue vlink=purple>

<div class=WordSection1>

<div style='border:none;border-bottom:solid #4F81BD 1.0pt;padding:0cm 0cm 4.0pt 0cm'>

<p class=MsoTitle>Working with Dependencies</p>

</div>

<p class=MsoTocHeading>Contents</p>

<p class=MsoToc2><a href="#_Toc336442151">Overview<span style='color:windowtext;
display:none;text-decoration:none'>.. </span><span
style='color:windowtext;display:none;text-decoration:none'>1</span></a></p>

<p class=MsoToc2><a href="#_Toc336442152">Introduction<span style='color:windowtext;
display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>1</span></a></p>

<p class=MsoToc2><a href="#_Toc336442153">Create the LogService bundle<span
style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>1</span></a></p>

<p class=MsoToc2><a href="#_Toc336442154">Add a Dependency between the two
Bundles<span style='color:windowtext;display:none;text-decoration:none'>. </span><span
style='color:windowtext;display:none;text-decoration:none'>2</span></a></p>

<p class=MsoToc2><a href="#_Toc336442155">Activating and deactivating Bundles
with Dependencies.<span style='color:windowtext;display:none;text-decoration:
none'> </span><span
style='color:windowtext;display:none;text-decoration:none'>4</span></a></p>

<p class=MsoNormal>&nbsp;</p>

<h2><a name="_Toc336442151"></a><a name="_Toc310867044">Overview</a></h2>

<p class=MsoNormal>A basic understanding of dependencies between bundles and
how these dependencies are resolved is the goal of this tutorial. We start out
with our HelloWorld bundle from the basic tutorial and add an OSGi service bundle
that logs our two messages from the Start and Stop methods in the HelloWorld
bundle.  </p>

<h2><a name="_Toc336442152">Introduction</a></h2>

<p class=MsoNormal>For those of you unfamiliar with the terms used when working
with bundles, a very short explanation of the most relevant terms for this
tutorial are presented.</p>

<p class=MsoNormal>The life cycle of a bundle represents the possible states a
bundle can take. Typically, when a bundle is activated it goes from an initial
uninstalled state, to be installed, resolved and then started. When started,
the bundle is in an active state. The most interesting state is probably the
resolved state, and the conditions that must be satisfied for a bundle to enter
the resolve state. If a bundle is resolved, it can become active and
collaborate with other resolved bundles. Before a bundle can enter the resolved
state, all dependencies the bundle has on other bundles must be satisfied.  </p>

<p class=MsoNormal>When a bundle is installed or updated  it is assigned a
revision and that revision has a wiring with the bundles it collaborate with. </p>

<h2><a name="_Toc336442153">Create the LogService bundle</a></h2>

<p class=MsoNormal>If you haven’t created the <a
href="Basic%20Tutorial%20Activating%20Bundles.htm">HelloWorld bundle</a>,
follow step 1 in the basic tutorial to do so. We follow the same procedure as
in the basic tutorial - Step 1 - to create the LogService bundle. Select the <b>OSGi
Simple LogService Example</b> template instead of the <b>Hello OSGi Bundle</b>
template to create the bundle in the <b>New Plug-in Project</b> wizard. Assure
that the <a
href="../tasks/Setting%20Bundle%20Options.htm#AddbintoBundleClassPathonActivate">Update
Bundle-ClassPath on Activate/Deactivate</a> option in the Bundle main menu is
checked.  </p>

<p class=MsoNormal>You should now have two projects in your workspace; - The
LogService; and - the HelloWorld project. Activate both bundles from the
Eclipse main menu by selecting the <b>Bundle | Activate Workspace (2) </b>menu
item where 2 specifies the number of deactivated bundles in the workspace. Both
bundle projects should now be activated and in state ACTIVE.</p>

<h2><a name="_Toc336442154">Add a Dependency between the two Bundles</a></h2>

<p class=MsoNormal>To provide and make the logging capability visible to the
HelloWorld and other bundles, the log capability has to be exported. In the
same manner, to consume a capability from another bundle, the exported capability
has to be imported.</p>

<p class=MsoNormal>To do so, edit the LogService manifest.mf file by selecting
the <b>Runtime</b> tab, then click the <b>Add ... </b>button<b> </b>in the <b>Exported
Packages</b> region and add the logservice package to the exported packages and
save the file.</p>

<p class=MsoNormal><img border=0 width=461 height=266
src="Tutorial%20Working%20with%20Multiple%20Bundles_files/image001.png" alt=" "></p>

<p class=MsoNormal>To import the logservice package edit the manifest.mf in the
HelloWorld project by selecting the <b>Dependencies</b> tab and click the <b>Add
… </b>button in the <b>Imported Packages </b>region. Then select the logservice
package and add it to the imported packages.</p>

<p class=MsoNormal><img border=0 width=417 height=294
src="Tutorial%20Working%20with%20Multiple%20Bundles_files/image002.png" alt=" "></p>

<p class=MsoNormal>Now, by saving the bundles (File | Save All), the HelloWorld
bundle becomes wired to the LogService bundle.  You can verify this by
selecting the <b>Show Bundle List Page</b> item from the Bundle main menu and select
the HelloWorld bundle in the Bundle List Page and then select the Bundle
Details Button<img border=0 width=16 height=16 id="Picture 2"
src="Tutorial%20Working%20with%20Multiple%20Bundles_files/image003.png">. This
reveals the <b>Bundle Details Page </b>for the HelloWorld Bundle.</p>

<p class=MsoNormal><img border=0 width=353 height=412
src="Tutorial%20Working%20with%20Multiple%20Bundles_files/image004.png" alt=" "></p>

<p class=MsoNormal>At this stage we see that HelloWorld consumes or requires
capabilities from LogService but is not registered with LogService service yet. 
By checking the link with button <img border=0 width=16 height=16 id="Picture 7"
src="Tutorial%20Working%20with%20Multiple%20Bundles_files/image005.gif"> in the
Bundle Details Page and selecting the LogService project in the Package
Explorer, we also see in the Details Page that the LogService bundle provides
capabilities to HelloWorld and that the LogService service is registered.</p>

<p class=MsoNormal>Now it is time to actually utilize the log service from
HelloWorld. To use a service we have to add some boiler plate code to access
the service from the HelloWorld bundle.</p>

<p class=MsoNormal>First import <b>org.osgi.util.tracker</b> into the
HelloWorld project in the same way as you imported the logservice package
earlier in this tutorial. </p>

<p class=MsoNormal>Replace all of the source code in the helloworld.Activator.java
file in the HelloWorld project with the content from the following listing. You
should be able to copy and paste the code in the listing. Then save the file.</p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:black'>package helloworld;</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:black'>&nbsp;</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:black'>import logservice.SimpleLogService;</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:black'>import org.osgi.framework.BundleActivator;</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:black'>import org.osgi.framework.BundleContext;</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:black'>import org.osgi.util.tracker.ServiceTracker;</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><b><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:#7F0055'>&nbsp;</span></b></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><b><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:#7F0055'>public</span></b><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:black'> </span><b><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:#7F0055'>class</span></b><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:black'> Activator </span><b><span style='font-size:8.0pt;font-family:
"Arial Rounded MT Bold","sans-serif";color:#7F0055'>implements</span></b><span
style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:black'> BundleActivator {</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:black'>      </span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:black'>      </span><b><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:#7F0055'>private</span></b><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:black'> ServiceTracker&lt;SimpleLogService, SimpleLogService&gt; </span><span
style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:#0000C0'>simpleLogServiceTracker</span><span style='font-size:8.0pt;
font-family:"Arial Rounded MT Bold","sans-serif";color:black'>;</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif"'>&nbsp;</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:black'>      </span><b><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:#7F0055'>public</span></b><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:black'> </span><b><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:#7F0055'>void</span></b><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:black'> start(BundleContext context) </span><b><span style='font-size:
8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";color:#7F0055'>throws</span></b><span
style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:black'> Exception {</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:black'>             </span><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:#0000C0'>simpleLogServiceTracker</span><span style='font-size:8.0pt;
font-family:"Arial Rounded MT Bold","sans-serif";color:black'> =  </span><b><span
style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:#7F0055'>new</span></b><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:black'> ServiceTracker&lt;SimpleLogService, SimpleLogService&gt;</span></p>

<p class=MsoNormal style='margin-top:0cm;margin-right:0cm;margin-bottom:0cm;
margin-left:70.8pt;margin-bottom:.0001pt;text-indent:35.4pt;line-height:normal;
text-autospace:none'><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:black'>(context, SimpleLogService.</span><b><span style='font-size:8.0pt;
font-family:"Arial Rounded MT Bold","sans-serif";color:#7F0055'>class</span></b><span
style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:black'>, </span><b><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:#7F0055'>null</span></b><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:black'>);</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:black'>             </span><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:#0000C0'>simpleLogServiceTracker</span><span style='font-size:8.0pt;
font-family:"Arial Rounded MT Bold","sans-serif";color:black'>.open();</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:black'>             log(</span><span style='font-size:8.0pt;font-family:
"Arial Rounded MT Bold","sans-serif";color:#2A00FF'>&quot;Hello World!! You
have changed&quot;</span><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:black'>);</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:black'>      }</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:black'>      </span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:black'>      </span><b><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:#7F0055'>public</span></b><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:black'> </span><b><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:#7F0055'>void</span></b><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:black'> stop(BundleContext context) </span><b><span style='font-size:
8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";color:#7F0055'>throws</span></b><span
style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:black'> Exception {</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:black'>             log(</span><span style='font-size:8.0pt;font-family:
"Arial Rounded MT Bold","sans-serif";color:#2A00FF'>&quot;Goodbye World!! I'll
be back&quot;</span><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:black'>);</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:black'>             </span><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:#0000C0'>simpleLogServiceTracker</span><span style='font-size:8.0pt;
font-family:"Arial Rounded MT Bold","sans-serif";color:black'>.close();</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:black'>             </span><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:#0000C0'>simpleLogServiceTracker</span><span style='font-size:8.0pt;
font-family:"Arial Rounded MT Bold","sans-serif";color:black'> = </span><b><span
style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:#7F0055'>null</span></b><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:black'>;                     </span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:black'>      }</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:black'>      </span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:black'>      </span><b><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:#7F0055'>private</span></b><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:black'> </span><b><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:#7F0055'>void</span></b><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:black'> log(String msg) {</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:black'>             SimpleLogService logService = getLogService();</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:black'>             </span><b><span style='font-size:8.0pt;font-family:
"Arial Rounded MT Bold","sans-serif";color:#7F0055'>if</span></b><span
style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:black'> (logService != </span><b><span style='font-size:8.0pt;font-family:
"Arial Rounded MT Bold","sans-serif";color:#7F0055'>null</span></b><span
style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:black'>) {</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:black'>                   </span><span lang=NO-BOK style='font-size:8.0pt;
font-family:"Arial Rounded MT Bold","sans-serif";color:black'>logService.log(msg);</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span lang=NO-BOK style='font-size:8.0pt;
font-family:"Arial Rounded MT Bold","sans-serif";color:black'>             } </span><b><span
lang=NO-BOK style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:#7F0055'>else</span></b><span lang=NO-BOK style='font-size:8.0pt;
font-family:"Arial Rounded MT Bold","sans-serif";color:black'> {</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span lang=NO-BOK style='font-size:8.0pt;
font-family:"Arial Rounded MT Bold","sans-serif";color:black'>                   System.</span><i><span
lang=NO-BOK style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:#0000C0'>out</span></i><span lang=NO-BOK style='font-size:8.0pt;
font-family:"Arial Rounded MT Bold","sans-serif";color:black'>.println(</span><span
lang=NO-BOK style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:#2A00FF'>&quot;Alternative log: &quot;</span><span lang=NO-BOK
style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:black'> + msg);</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span lang=NO-BOK style='font-size:8.0pt;
font-family:"Arial Rounded MT Bold","sans-serif";color:black'>             </span><span
style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:black'>}</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:black'>      }</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif"'>&nbsp;</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:black'>      </span><b><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:#7F0055'>private</span></b><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:black'> SimpleLogService getLogService() {</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:black'>             </span><b><span style='font-size:8.0pt;font-family:
"Arial Rounded MT Bold","sans-serif";color:#7F0055'>return</span></b><span
style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:black'>     </span><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:#0000C0'>simpleLogServiceTracker</span><span style='font-size:8.0pt;
font-family:"Arial Rounded MT Bold","sans-serif";color:black'>.getService();</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:black'>      }</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif";
color:black'>}</span></p>

<p class=MsoNormal style='margin-bottom:0cm;margin-bottom:.0001pt;line-height:
normal;text-autospace:none'><span style='font-size:8.0pt;font-family:"Arial Rounded MT Bold","sans-serif"'>&nbsp;</span></p>

<p class=MsoNormal>If built successfully, the HelloWorld bundle is updated and
re-wired with the LogService. If you now take a look at the Bundle Details Page
of the HelloWorld project again, the Services in use field reveals that the
LogService service is in use by the HelloWorld bundle.  The output in the Bundle
Console Page is the same as before, except that now it is routed through the
LogService service. If closed, open the Bundle Console Page from the Bundle
main menu.</p>

<p class=MsoNormal>We have now registered the LogService bundle as a service
using the OSGi service platform and implemented a consumer of that service.</p>

<h2><a name="_Toc336442155">Activating and deactivating Bundles with
Dependencies.</a></h2>

<p class=MsoNormal>By now we know that HelloWorld requires log capabilities
from LogService and LogService provide log capabilities to HelloWorld and to
bundles in general.</p>

<p class=MsoNormal>If we deactivate LogService, both the HelloWorld and the
LogService bundles will be deactivated and enter state UNINSTALLED. </p>

<p class=MsoNormal>A bundle is resolved (state RESOLVED) before it is started
(state ACTIVE).  During the time HelloWorld is resolved it will be in a stable
state with respect to its code dependencies. LogService can be unresolved
(entering state INSTALLED) and uninstalled during its life cycle. However, as
long as HelloWorld is resolved it will continue to load classes from the
LogService bundle revision it was wired to when it was initially resolved and
started, even if LogService is unresolved or uninstalled.</p>

<p class=MsoNormal>One alternative is to let HelloWorld stay resolved and be in
an active state, after LogService has been uninstalled, and function as normal.
Another alternative is to implicit deactivate all bundles that, directly and
indirectly, require capabilities from the bundle being deactivated.  In a
development environment, where bundles are continuously changed the default is
to deactivate requiring bundles when a provider is deactivated. </p>

<p class=MsoNormal>In our case HelloWorld is deactivated along with LogService.
The dependencies are directed, so if you deactivate HelloWorld, LogService will
stay activated.</p>

<p class=MsoNormal>The same applies when activating bundles, but in the
opposite direction.  If you activate HelloWorld, LogService will be activated
as well. If you activate LogService, HelloWorld stays deactivated.  It is
possible to influence in to which extend dependent bundles are being activated,
deactivated, started or stopped by the <a
href="../tasks/Setting%20Bundle%20Options.htm#Dependencies">Partial
Dependencies</a>  option.</p>

<p class=MsoNormal>Also note that dependencies are transitive. If bundle A is
dependent on bundle B and B is dependent on bundle C, than bundle A is
dependent on bundle C. This may result in a cascade of activations or
deactivations when a bundle is activated or deactivated.</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

<p class=MsoNormal>&nbsp;</p>

</div>

</body>

</html>
